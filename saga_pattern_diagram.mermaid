erDiagram
    PAIS {
        int PaisId PK
        string PaisNombre
        string PaisImage
    }

    CLIENTE {
        int ClienteId PK
        string ClienteNombre
        string ClienteEmail
        int PaisId FK
    }

    LUGAR {
        int LugarId PK
        string LugarNombre
        int PaisId FK
        int LugarCapacidad
        int LugarEspectaculoCant
        string LugarImage
    }

    SECTOR {
        int SectorId PK
        int LugarId FK
        string SectorNombre
        float SectorPrecio
        int SectorCapacidadDiurna
        int SectorCapacidadNocturna
    }

    TIPOESPECTACULO {
        int TipoEspectaculoId PK
        string TipoEspectaculoNomb
        string TipoEspectaculoImage
    }

    ESPECTACULO {
        int EspectaculoId PK
        string EspectaculoNombre
        string EspectaculoDescrpici
        date EspectaculoDate
        string EspectaculoImage
        int EspectaculoPaisOrigenId FK "Origen"
        int LugarId FK
        int TipoEspectaculoId FK
        int EspectaculoCapacidad
    }

    PERFORMANCE {
        int PerformanceId PK
        int EspectaculoId FK
        datetime PerformanceFechaHora
        int DuracionMinutos
        string Estado
    }

    BENEFICIO {
        int BeneficioId PK
        int LugarId FK 
        string BeneficioDescripcion
        float BeneficioCosto
        date BeneficioVigenciaDesde
        date BeneficioVigenciaHasta
    }

    NOTICIA {
        int NoticiaId PK
        int EspectaculoId FK
        date NoticiaFecha
        string NoticiaTexto
        int NoticiaPadreId FK "Recursiva"
    }

    ENTRADA {
        int EntradaId PK
        datetime EntradaFecha
        int ClienteId FK
        int PerformanceId FK
        int SectorId FK
        float EntradaPrecio
        string EntradaEstado
    }

    INVITACION {
        int InvitacionId PK
        int ClienteId FK
        int EspectaculoId FK
        datetime FechaInvitacion
        string CodigoInvitacion
    }

    FACTURA {
        int FacturaId PK
        int ClienteId FK
        date FacturaFecha
        float FacturaTotal
        string FacturaEstado
    }

    FACTURA_LINEA {
        int FacturaLineaId PK
        int FacturaId FK
        int EntradaId FK
        int BeneficioId FK
        float PrecioUnitario
        int Cantidad
        float Subtotal
    }

    %% RELACIONES DEFINIDAS
    PAIS ||--o{ CLIENTE : "tiene"
    PAIS ||--o{ LUGAR : "ubicado en"
    PAIS ||--o{ ESPECTACULO : "origen"

    LUGAR ||--o{ SECTOR : "contiene"
    LUGAR ||--o{ ESPECTACULO : "alberga"
    LUGAR ||--o{ BENEFICIO : "ofrece" 

    TIPOESPECTACULO ||--o{ ESPECTACULO : "categoria"
    ESPECTACULO ||--o{ PERFORMANCE : "tiene"
    ESPECTACULO ||--o{ NOTICIA : "publica"
    
    %% Relación Recursiva en NOTICIA
    NOTICIA ||--o{ NOTICIA : "evolucion de"

    PERFORMANCE ||--o{ ENTRADA : "genera"
    CLIENTE ||--o{ ENTRADA : "compra"

    CLIENTE ||--o{ INVITACION : "recibe"
    ESPECTACULO ||--o{ INVITACION : "genera"

    CLIENTE ||--o{ FACTURA : "recibe"
    FACTURA ||--o{ FACTURA_LINEA : "contiene"
    
    %% Opcionalidad (NULL en la FK) se maneja en la relación: |o--o| (uno a cero o uno)
    ENTRADA o|--o{ FACTURA_LINEA : "relaciona"
    BENEFICIO o|--o{ FACTURA_LINEA : "relaciona"
